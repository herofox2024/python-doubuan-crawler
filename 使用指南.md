# 豆瓣书评爬虫工具 - 完整版使用指南

## 🎉 功能完成情况

### ✅ 已实现功能
1. **数据库存储** - 使用SQLite数据库替代Excel文件
2. **GUI界面** - 友好的图形用户界面，支持实时进度显示
3. **HTML导出** - 生成美观的交互式HTML报告
4. **命令行支持** - 支持自动化脚本调用
5. **数据管理** - 支持增量更新、数据统计、历史记录

## 📁 新增文件
- `database.py` - 数据库操作模块
- `gui.py` - GUI界面模块  
- `crawler_with_db.py` - 改进的爬虫模块
- `html_exporter.py` - HTML导出模块
- `main.py` - 主程序入口
- `test_all.py` - 功能测试脚本
- `README_NEW.md` - 详细使用说明

## 🚀 快速开始

### 方式1: GUI界面（推荐新手）
```bash
python main.py
```

### 方式2: 命令行模式
```bash
# 交互式使用
python main.py --cli

# 指定参数使用
python main.py --cli --user 用户名 --cookie "你的Cookie" --max-pages 10
```

### 方式3: 仅导出HTML
```bash
python main.py --export 用户名 --output 报告.html
```

## 🔧 Cookie配置

### 获取方法
1. 浏览器登录豆瓣 → 访问收藏页面
2. F12开发者工具 → Network标签页
3. 刷新页面 → 找到页面请求 → 复制Cookie

### 配置方式
- **GUI模式**: 在界面中输入Cookie（自动保存）
- **命令行**: 设置环境变量 `DOUBAN_COOKIE` 或使用 `--cookie` 参数

## 📊 HTML报告特性

生成的HTML文件包含：
- 📈 统计信息（总书籍、书评数、评分分布）
- 🔍 实时搜索（书名、作者、书评内容）
- 🏷️ 评分筛选（按星级、是否有书评）
- 📱 响应式设计（支持手机浏览）
- 🎨 美观的卡片式布局

## 💾 数据管理

### 数据库文件
- `douban_books.db` - SQLite数据库，存储所有数据
- 支持多用户数据存储
- 自动去重，防止重复爬取
- 记录爬取历史和统计信息

### 数据导出
- Excel格式：与原版兼容
- HTML格式：新增的交互式报告
- JSON格式：用于数据分析

## 🔍 测试验证

运行完整测试：
```bash
python test_all.py
```

测试结果显示所有5项测试通过：
- ✅ 数据库功能正常
- ✅ HTML导出成功
- ✅ GUI模块加载正常
- ✅ 爬虫模块工作正常
- ✅ 测试数据清理完成

## 📋 使用建议

### 新手用户
1. 使用GUI界面：`python main.py`
2. 按照界面提示输入用户名和Cookie
3. 设置适当的页数限制（建议5-10页测试）
4. 爬取完成后点击"导出HTML"查看结果

### 高级用户
1. 使用命令行模式实现自动化
2. 设置环境变量简化配置
3. 结合其他脚本处理数据
4. 定期增量更新数据

## ⚠️ 注意事项

1. **Cookie时效性** - Cookie会过期，需要定期更新
2. **爬取频率** - 建议控制爬取速度，避免被限制
3. **数据备份** - 定期备份数据库文件
4. **网络环境** - 确保网络连接稳定

## 🆕 相比原版的改进

| 功能 | 原版 | 新版 |
|------|------|------|
| 数据存储 | Excel文件 | SQLite数据库 |
| 用户界面 | 命令行 | GUI + 命令行 |
| 数据导出 | Excel | Excel + HTML |
| 进度显示 | 文本输出 | 图形进度条 |
| 数据管理 | 文件替换 | 增量更新 |
| 错误处理 | 基础 | 完善重试机制 |
| 数据查看 | Excel表格 | 交互式网页 |

## 🎯 后续可能的扩展

1. 数据可视化图表
2. 读书统计分析
3. 书籍推荐算法
4. 云端数据同步
5. 移动应用支持

---

**工具已准备就绪，可以开始使用！**